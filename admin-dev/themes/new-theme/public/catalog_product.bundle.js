/******/!function(e){function i(r){if(t[r])return t[r].exports;var c=t[r]={i:r,l:!1,exports:{}};return e[r].call(c.exports,c,c.exports,i),c.l=!0,c.exports}// webpackBootstrap
/******/
var t={};i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},i.p="",i(i.s=380)}({189:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t(229);(0,window.$)(function(){new r.a})},229:function(e,i,t){"use strict";function r(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var c=function(){function e(e,i){for(var t=0;t<i.length;t++){var r=i[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(i,t,r){return t&&e(i.prototype,t),r&&e(i,r),i}}(),n=window.$,o=function(){function e(){r(this,e),this.prefixCreateForm="form_step2_specific_price_",this.prefixEditForm="form_modal_",this.$createPriceFormDefaultValues=new Object,this.storePriceFormDefaultValues(),this.loadAndDisplayExistingSpecificPricesList(),this.configureAddPriceFormBehavior(),this.configureEditPriceModalBehavior(),this.configureDeletePriceButtonsBehavior()}return c(e,[{key:"loadAndDisplayExistingSpecificPricesList",value:function(){var e=this,i=n("#js-specific-price-list"),t=i.attr("data").replace(/list\/\d+/,"list/"+this.getProductId());n.ajax({type:"GET",url:t}).done(function(t){var r=i.find("tbody");r.find("tr").remove(),t.length>0?i.removeClass("hide"):i.addClass("hide");var c=e.renderSpecificPricesListingAsHtml(t);r.append(c)})}},{key:"renderSpecificPricesListingAsHtml",value:function(e){var i="",t=this;return n.each(e,function(e,r){var c=n("#js-specific-price-list").attr("data-action-delete").replace(/delete\/\d+/,"delete/"+r.id_specific_price),o=t.renderSpecificPriceRow(r,c);i+=o}),i}},{key:"renderSpecificPriceRow",value:function(e,i){var t=e.id_specific_price;return"<tr><td>"+e.rule_name+"</td><td>"+e.attributes_name+"</td><td>"+e.currency+"</td><td>"+e.country+"</td><td>"+e.group+"</td><td>"+e.customer+"</td><td>"+e.fixed_price+"</td><td>"+e.impact+"</td><td>"+e.period+"</td><td>"+e.from_quantity+"</td><td>"+(e.can_delete?'<a href="'+i+'" class="js-delete delete btn tooltip-link delete pl-0 pr-0"><i class="material-icons">delete</i></a>':"")+"</td><td>"+(e.can_edit?'<a href="#" data-specific-price-id="'+t+'" class="js-edit edit btn tooltip-link delete pl-0 pr-0"><i class="material-icons">edit</i></a>':"")+"</td></tr>"}},{key:"configureAddPriceFormBehavior",value:function(){var e=this,i=this.getPrefixSelector(!0);n("#specific_price_form .js-cancel").click(function(){e.resetCreatePriceFormDefaultValues(),n("#specific_price_form").collapse("hide")}),n("#specific_price_form .js-save").on("click",function(){return e.submitCreatePriceForm()}),this.loadAndFillOptionsForSelectCombinationInput(!0),n(i+"sp_reduction_type").change(function(){return e.showSpecificPriceTaxFieldIfEligible(!0)}),n(i+"leave_bprice").on("click",function(){return e.enableSpecificPriceFieldIfEligible(!0)}),n(i+"sp_reduction_type").on("change",function(){return e.enableSpecificPriceTaxFieldIfEligible(!0)})}},{key:"configureEditPriceFormInsideModalBehavior",value:function(){var e=this,i=this.getPrefixSelector(!1);n("#edit-specific-price-modal-form .js-cancel").click(function(){return e.closeEditPriceModalAndRemoveForm()}),this.loadAndFillOptionsForSelectCombinationInput(!1),n(i+"sp_reduction_type").change(function(){return e.showSpecificPriceTaxFieldIfEligible(!1)}),n(i+"leave_bprice").on("click",function(){return e.enableSpecificPriceFieldIfEligible(!1)}),n(i+"sp_reduction_type").on("change",function(){return e.enableSpecificPriceTaxFieldIfEligible(!1)}),this.reinitializeDatePickers(),this.initializeLeaveBPriceField(!1)}},{key:"reinitializeDatePickers",value:function(){n(".datepicker input").datetimepicker({format:"YYYY-MM-DD"})}},{key:"initializeLeaveBPriceField",value:function(e){var i=this.getPrefixSelector(e);""!=n(i+"sp_price").val()&&(n(i+"sp_price").prop("disabled",!1),n(i+"leave_bprice").prop("checked",!1))}},{key:"configureEditPriceModalBehavior",value:function(){var e=this;n(document).on("click","#js-specific-price-list .js-edit",function(i){i.preventDefault();var t=n(i.currentTarget).data("specificPriceId");e.openEditPriceModalAndLoadForm(t)})}},{key:"configureDeletePriceButtonsBehavior",value:function(){var e=this;n(document).on("click","#js-specific-price-list .js-delete",function(i){i.preventDefault(),e.deleteSpecificPrice(i.currentTarget)})}},{key:"submitCreatePriceForm",value:function(){var e=this,i=n("#specific_price_form").attr("data-action"),t=n("#specific_price_form input, #specific_price_form select, #form_id_product").serialize();n("#specific_price_form .js-save").attr("disabled","disabled"),n.ajax({type:"POST",url:i,data:t}).done(function(i){showSuccessMessage(translate_javascripts["Form update success"]),e.resetCreatePriceFormDefaultValues(),n("#specific_price_form").collapse("hide"),e.loadAndDisplayExistingSpecificPricesList(),n("#specific_price_form .js-save").removeAttr("disabled")}).fail(function(e){showErrorMessage(e.responseJSON),n("#specific_price_form .js-save").removeAttr("disabled")})}},{key:"deleteSpecificPrice",value:function(e){var i=this;modalConfirmation.create(translate_javascripts["This will delete the specific price. Do you wish to proceed?"],null,{onContinue:function(){var t=n(e).attr("href");n(e).attr("disabled","disabled"),n.ajax({type:"GET",url:t}).done(function(t){i.loadAndDisplayExistingSpecificPricesList(),showSuccessMessage(t),n(e).removeAttr("disabled")}).fail(function(i){showErrorMessage(i.responseJSON),n(e).removeAttr("disabled")})}}).show()}},{key:"storePriceFormDefaultValues",value:function(){var e=this.$createPriceFormDefaultValues;n("#specific_price_form").find("select,input").each(function(i,t){e[n(t).attr("id")]=n(t).val()}),n("#specific_price_form").find("input:checkbox").each(function(i,t){e[n(t).attr("id")]=n(t).prop("checked")}),this.$createPriceFormDefaultValues=e}},{key:"loadAndFillOptionsForSelectCombinationInput",value:function(e){var i=this.getPrefixSelector(e),t=n(i+"sp_id_product_attribute"),r=t.attr("data-action").replace(/product-combinations\/\d+/,"product-combinations/"+this.getProductId());n.ajax({type:"GET",url:r}).done(function(e){t.find("option:gt(0)").remove(),n.each(e,function(e,i){t.append('<option value="'+i.id+'">'+i.name+"</option>")}),"0"!=t.data("selectedAttribute")&&t.val(t.data("selectedAttribute")).trigger("change")})}},{key:"showSpecificPriceTaxFieldIfEligible",value:function(e){var i=this.getPrefixSelector(e);"percentage"===n(i+"sp_reduction_type").val()?n(i+"sp_reduction_tax").hide():n(i+"sp_reduction_tax").show()}},{key:"resetCreatePriceFormDefaultValues",value:function(){var e=this.$createPriceFormDefaultValues;n("#specific_price_form").find("input").each(function(i,t){n(t).val(e[n(t).attr("id")])}),n("#specific_price_form").find("select").each(function(i,t){n(t).val(e[n(t).attr("id")]).change()}),n("#specific_price_form").find("input:checkbox").each(function(e,i){n(i).prop("checked",!0)})}},{key:"enableSpecificPriceFieldIfEligible",value:function(e){var i=this.getPrefixSelector(e);n(i+"sp_price").prop("disabled",n(i+"leave_bprice").is(":checked")).val("")}},{key:"enableSpecificPriceTaxFieldIfEligible",value:function(e){var i=this.getPrefixSelector(e),t=n("#select2-"+i+"sp_reduction_tax-container").parent().parent();"amount"===n(i+"sp_reduction_type").val()?t.show():t.hide()}},{key:"openEditPriceModalAndLoadForm",value:function(e){var i=this,t=n("#js-specific-price-list").data("actionEdit").replace(/get-form\/\d+/,"get-form/"+e);n("#edit-specific-price-modal").modal("show"),n.ajax({type:"GET",url:t}).done(function(e){i.insertEditSpecificPriceFormIntoModal(e),i.configureEditPriceFormInsideModalBehavior()}).fail(function(e){showErrorMessage(e.responseJSON)})}},{key:"closeEditPriceModalAndRemoveForm",value:function(){n("#edit-specific-price-modal").modal("hide"),n("#edit-specific-price-modal-form").empty()}},{key:"insertEditSpecificPriceFormIntoModal",value:function(e){var i=n("#edit-specific-price-modal-form");i.empty(),i.append(e)}},{key:"getProductId",value:function(){return n("#form_id_product").val()}},{key:"getPrefixSelector",value:function(e){return 1==e?"#"+this.prefixCreateForm:"#"+this.prefixEditForm}}]),e}();i.a=o},380:function(e,i,t){e.exports=t(189)}});