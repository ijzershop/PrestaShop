/*
* 2010-2020 Tuni-Soft
*
* NOTICE OF LICENSE
*
* This source file is subject to the Academic Free License (AFL 3.0)
* It is available through the world-wide-web at this URL:
* http://opensource.org/licenses/afl-3.0.php
* If you did not receive a copy of the license and are unable to
* obtain it through the world-wide-web, please send an email
* to license@prestashop.com so we can send you a copy immediately.
*
* DISCLAIMER
*
* Do not edit or add to this file if you wish to upgrade this module to newer
* versions in the future. If you wish to customize the module for your
* needs please refer to
* http://doc.prestashop.com/display/PS15/Overriding+default+behaviors
* for more information.
*
* @author    Tuni-Soft
* @copyright 2010-2020 Tuni-Soft
* @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
*/

!function(c){var r,e,i,a,n,t,l,d,s,p,u,o,h,f,v,m,g,k,b,_,x=(e={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!(r=65)},i=function(e){var o,t=c(this).parent().parent();0<this.parentNode.className.indexOf("_hex")?t.data("colorpicker").color=o=g(m(this.value)):0<this.parentNode.className.indexOf("_hsb")?t.data("colorpicker").color=o=f({h:parseInt(t.data("colorpicker").fields.eq(4).val(),10),s:parseInt(t.data("colorpicker").fields.eq(5).val(),10),b:parseInt(t.data("colorpicker").fields.eq(6).val(),10)}):t.data("colorpicker").color=o=k(v({r:parseInt(t.data("colorpicker").fields.eq(1).val(),10),g:parseInt(t.data("colorpicker").fields.eq(2).val(),10),b:parseInt(t.data("colorpicker").fields.eq(3).val(),10)})),e&&(w(o,t.get(0)),C(o,t.get(0)),y(o,t.get(0))),M(o,t.get(0)),I(o,t.get(0)),P(o,t.get(0)),t.data("colorpicker").onChange.apply(t,[o,_(o),b(o)])},a=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&i.apply(e.data.field.get(0),[!0]),!1},n=function(e){return i.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colorpicker_slider").find("input").focus(),c(document).unbind("mouseup",n),c(document).unbind("mousemove",a),!1},t=function(e){return i.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},l=function(e){return t(e),w(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),C(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),c(document).unbind("mouseup",l),c(document).unbind("mousemove",t),p.apply(c(e.target),[e]),!1},d=function(e){return i.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},s=function(e){return d(e),w(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),C(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),c(document).unbind("mouseup",s),c(document).unbind("mousemove",d),p.apply(c(e.target).closest(".colorpicker_color"),[e]),!1},p=function(e){var o=c(this).parent();o.hasClass("colorpicker")||(o=c(e.target));var t=o.data("colorpicker").color;o.data("colorpicker").origColor=t,q(t,o.get(0)),o.data("colorpicker").onSubmit(t,_(t),b(t),o.data("colorpicker").el)},u=function(e){o(e.data.cal.get(0),e.target,e.data.cal.get(0))||(0!=e.data.cal.data("colorpicker").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),c(document).unbind("mousedown",u))},o=function(e,o,t){if(e==o)return!0;if(e.contains)return e.contains(o);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(o));for(var r=o.parentNode;r&&r!=t;){if(r==e)return!0;r=r.parentNode}return!1},h=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},f=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},v=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},m=function(e){var o=6-e.length;if(0<o){for(var t=[],r=0;r<o;r++)t.push("0");t.push(e),e=t.join("")}return e},g=function(e){return k((o=e,{r:(o=parseInt(-1<o.indexOf("#")?o.substring(1):o,16))>>16,g:(65280&o)>>8,b:255&o}));var o},k=function(e){var o={h:0,s:0,b:0},t=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-t;return o.b=r,o.s=0!=r?255*i/r:0,0!=o.s?e.r==r?o.h=(e.g-e.b)/i:e.g==r?o.h=2+(e.b-e.r)/i:o.h=4+(e.r-e.g)/i:o.h=-1,o.h*=60,o.h<0&&(o.h+=360),o.s*=100/255,o.b*=100/255,o},b=function(e){var o={},t=Math.round(e.h),r=Math.round(255*e.s/100),i=Math.round(255*e.b/100);if(0==r)o.r=o.g=o.b=i;else{var a=i,c=(255-r)*i/255,n=t%60*(a-c)/60;360==t&&(t=0),t<60?(o.r=a,o.b=c,o.g=c+n):t<120?(o.g=a,o.b=c,o.r=a-n):t<180?(o.g=a,o.r=c,o.b=c+n):t<240?(o.b=a,o.r=c,o.g=a-n):t<300?(o.b=a,o.g=c,o.r=c+n):t<360?(o.r=a,o.g=c,o.b=a-n):(o.r=0,o.g=0,o.b=0)}return{r:Math.round(o.r),g:Math.round(o.g),b:Math.round(o.b)}},_=function(e){return o=b(e),t=[o.r.toString(16),o.g.toString(16),o.b.toString(16)],c.each(t,function(e,o){1==o.length&&(t[e]="0"+o)}),t.join("");var o,t},{init:function(r){if("string"==typeof(r=c.extend({},e,r||{})).color)r.color=g(r.color);else if(null!=r.color.r&&null!=r.color.g&&null!=r.color.b)r.color=k(r.color);else{if(null==r.color.h||null==r.color.s||null==r.color.b)return this;r.color=f(r.color)}return this.each(function(){if(!c(this).data("colorpickerId")){var e=c.extend({},r);e.origColor=r.color;var o="collorpicker_"+parseInt(1e3*Math.random());c(this).data("colorpickerId",o);var t=c('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",o);e.flat?t.appendTo(this).show():t.appendTo(document.body),e.fields=t.find("input").bind("keyup",N).bind("change",i).bind("blur",S).bind("focus",H),t.find("span").bind("mousedown",O).end().find(">div.colorpicker_current_color").bind("click",W),e.selector=t.find("div.colorpicker_color").bind("mousedown",Y),e.selectorIndic=e.selector.find("div div"),e.el=this,e.hue=t.find("div.colorpicker_hue div"),t.find("div.colorpicker_hue").bind("mousedown",z),e.newColor=t.find("div.colorpicker_new_color"),e.currentColor=t.find("div.colorpicker_current_color"),t.data("colorpicker",e),t.find("div.colorpicker_submit").bind("mouseenter",E).bind("mouseleave",T).bind("click",p),w(e.color,t.get(0)),y(e.color,t.get(0)),C(e.color,t.get(0)),I(e.color,t.get(0)),M(e.color,t.get(0)),q(e.color,t.get(0)),P(e.color,t.get(0)),e.flat?t.css({position:"relative",display:"block"}):c(this).bind(e.eventName,j)}})},showPicker:function(){return this.each(function(){c(this).data("colorpickerId")&&j.apply(this)})},hidePicker:function(){return this.each(function(){c(this).data("colorpickerId")&&c("#"+c(this).data("colorpickerId")).hide()})},setColor:function(o){if("string"==typeof o)o=g(o);else if(null!=o.r&&null!=o.g&&null!=o.b)o=k(o);else{if(null==o.h||null==o.s||null==o.b)return this;o=f(o)}return this.each(function(){if(c(this).data("colorpickerId")){var e=c("#"+c(this).data("colorpickerId"));e.data("colorpicker").color=o,e.data("colorpicker").origColor=o,w(o,e.get(0)),y(o,e.get(0)),C(o,e.get(0)),I(o,e.get(0)),M(o,e.get(0)),q(o,e.get(0)),P(o,e.get(0))}})}});function w(e,o){var t=b(e);c(o).data("colorpicker").fields.eq(1).val(t.r).end().eq(2).val(t.g).end().eq(3).val(t.b).end()}function y(e,o){c(o).data("colorpicker").fields.eq(4).val(e.h).end().eq(5).val(e.s).end().eq(6).val(e.b).end()}function C(e,o){c(o).data("colorpicker").fields.eq(0).val(_(e)).end()}function M(e,o){c(o).data("colorpicker").selector.css("backgroundColor","#"+_({h:e.h,s:100,b:100})),c(o).data("colorpicker").selectorIndic.css({left:parseInt(150*e.s/100,10),top:parseInt(150*(100-e.b)/100,10)})}function I(e,o){c(o).data("colorpicker").hue.css("top",parseInt(150-150*e.h/360,10))}function q(e,o){c(o).data("colorpicker").currentColor.css("backgroundColor","#"+_(e))}function P(e,o){c(o).data("colorpicker").newColor.css("backgroundColor","#"+_(e))}function N(e){var o=e.charCode||e.keyCode||-1;if(r<o&&o<=90||32==o)return!1;var t=c(this).parent().parent();13==o&&t.find("div.colorpicker_submit").click(),!0===t.data("colorpicker").livePreview&&i.apply(this)}function S(e){c(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")}function H(){r=0<this.parentNode.className.indexOf("_hex")?70:65,c(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),c(this).parent().addClass("colorpicker_focus")}function O(e){var o=c(this).parent().find("input").focus(),t={el:c(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:e.pageY,field:o,val:parseInt(o.val(),10),preview:c(this).parent().parent().data("colorpicker").livePreview};c(document).bind("mouseup",t,n),c(document).bind("mousemove",t,a)}function z(e){var o={cal:c(this).parent(),y:c(this).offset().top};o.preview=o.cal.data("colorpicker").livePreview,c(document).bind("mouseup",o,l),c(document).bind("mousemove",o,t)}function Y(e){var o={cal:c(this).parent(),pos:c(this).offset()};o.preview=o.cal.data("colorpicker").livePreview,c(document).bind("mouseup",o,s),c(document).bind("mousemove",o,d)}function E(e){c(this).addClass("colorpicker_focus")}function T(e){c(this).removeClass("colorpicker_focus")}function j(e){var o=c("#"+c(this).data("colorpickerId"));o.data("colorpicker").onBeforeShow.apply(this,[o.get(0)]);var t=c(this).offset(),r=h(),i=t.top+this.offsetHeight,a=t.left;return i+176>r.t+r.h&&(i-=this.offsetHeight+176),a+356>r.l+r.w&&(a-=356),o.css({left:a+"px",top:i+"px"}),0!=o.data("colorpicker").onShow.apply(this,[o.get(0)])&&o.show(),c(document).bind("mousedown",{cal:o},u),!1}function W(){var e=c(this).parent(),o=e.data("colorpicker").origColor;e.data("colorpicker").color=o,w(o,e.get(0)),C(o,e.get(0)),y(o,e.get(0)),M(o,e.get(0)),I(o,e.get(0)),P(o,e.get(0))}c.fn.extend({ColorPicker:x.init,ColorPickerHide:x.hidePicker,ColorPickerShow:x.showPicker,ColorPickerSetColor:x.setColor})}(jQuery);