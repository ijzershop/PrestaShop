/*
* 2010-2019 Tuni-Soft
*
* NOTICE OF LICENSE
*
* This source file is subject to the Academic Free License (AFL 3.0)
* It is available through the world-wide-web at this URL:
* http://opensource.org/licenses/afl-3.0.php
* If you did not receive a copy of the license and are unable to
* obtain it through the world-wide-web, please send an email
* to license@prestashop.com so we can send you a copy immediately.
*
* DISCLAIMER
*
* Do not edit or add to this file if you wish to upgrade this module to newer
* versions in the future. If you wish to customize the module for your
* needs please refer to
* http://doc.prestashop.com/display/PS15/Overriding+default+behaviors
* for more information.
*
* @author    Tuni-Soft
* @copyright 2010-2019 Tuni-Soft
* @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
*/

!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(X){"use strict";function r(e){var t=e.data;e.isDefaultPrevented()||(e.preventDefault(),X(e.target).ajaxSubmit(t))}function a(e){var t=e.target,r=X(t);if(!r.is("[type=submit],[type=image]")){var a=r.closest("[type=submit]");if(0===a.length)return;t=a[0]}var n=this;if("image"==(n.clk=t).type)if(void 0!==e.offsetX)n.clk_x=e.offsetX,n.clk_y=e.offsetY;else if("function"==typeof X.fn.offset){var i=r.offset();n.clk_x=e.pageX-i.left,n.clk_y=e.pageY-i.top}else n.clk_x=e.pageX-t.offsetLeft,n.clk_y=e.pageY-t.offsetTop;setTimeout(function(){n.clk=n.clk_x=n.clk_y=null},100)}function C(){if(X.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var b={};b.fileapi=void 0!==X("<input type='file'/>").get(0).files,b.formdata=void 0!==window.FormData;var _=!!X.fn.prop;X.fn.attr2=function(){if(!_)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},X.fn.ajaxSubmit=function(E){function e(e){function l(t){var r=null;try{t.contentWindow&&(r=t.contentWindow.document)}catch(e){C("cannot get iframe.contentWindow document: "+e)}if(r)return r;try{r=t.contentDocument?t.contentDocument:t.document}catch(e){C("cannot get iframe.contentDocument: "+e),r=t.document}return r}function t(){var e=F.attr2("target"),t=F.attr2("action"),r=F.attr("enctype")||F.attr("encoding")||"multipart/form-data";s.setAttribute("target",i),(!M||/post/i.test(M))&&s.setAttribute("method","POST"),t!=m.url&&s.setAttribute("action",m.url),m.skipEncodingOverride||M&&!/post/i.test(M)||F.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),m.timeout&&(x=setTimeout(function(){g=!0,f(y)},m.timeout));var a=[];try{if(m.extraData)for(var n in m.extraData)m.extraData.hasOwnProperty(n)&&a.push(X.isPlainObject(m.extraData[n])&&m.extraData[n].hasOwnProperty("name")&&m.extraData[n].hasOwnProperty("value")?X('<input type="hidden" name="'+m.extraData[n].name+'">').val(m.extraData[n].value).appendTo(s)[0]:X('<input type="hidden" name="'+n+'">').val(m.extraData[n]).appendTo(s)[0]);m.iframeTarget||d.appendTo("body"),h.attachEvent?h.attachEvent("onload",f):h.addEventListener("load",f,!1),setTimeout(function e(){try{var t=l(h).readyState;C("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(e){C("Server abort: ",e," (",e.name,")"),f(T),x&&clearTimeout(x),x=void 0}},15);try{s.submit()}catch(e){document.createElement("form").submit.apply(s)}}finally{s.setAttribute("action",t),s.setAttribute("enctype",r),e?s.setAttribute("target",e):F.removeAttr("target"),X(a).remove()}}function f(e){if(!v.aborted&&!S){if((w=l(h))||(C("cannot access response document"),e=T),e===y&&v)return v.abort("timeout"),void b.reject(v,"timeout");if(e==T&&v)return v.abort("server abort"),void b.reject(v,"error","server abort");if(w&&w.location.href!=m.iframeSrc||g){h.detachEvent?h.detachEvent("onload",f):h.removeEventListener("load",f,!1);var t,r="success";try{if(g)throw"timeout";var a="xml"==m.dataType||w.XMLDocument||X.isXMLDoc(w);if(C("isXml="+a),!a&&window.opera&&(null===w.body||!w.body.innerHTML)&&--D)return C("requeing onLoad callback, DOM not available"),void setTimeout(f,250);var n=w.body?w.body:w.documentElement;v.responseText=n?n.innerHTML:null,v.responseXML=w.XMLDocument?w.XMLDocument:w,a&&(m.dataType="xml"),v.getResponseHeader=function(e){return{"content-type":m.dataType}[e.toLowerCase()]},n&&(v.status=Number(n.getAttribute("status"))||v.status,v.statusText=n.getAttribute("statusText")||v.statusText);var i=(m.dataType||"").toLowerCase(),o=/(json|script|text)/.test(i);if(o||m.textarea){var s=w.getElementsByTagName("textarea")[0];if(s)v.responseText=s.value,v.status=Number(s.getAttribute("status"))||v.status,v.statusText=s.getAttribute("statusText")||v.statusText;else if(o){var u=w.getElementsByTagName("pre")[0],c=w.getElementsByTagName("body")[0];u?v.responseText=u.textContent?u.textContent:u.innerText:c&&(v.responseText=c.textContent?c.textContent:c.innerText)}}else"xml"==i&&!v.responseXML&&v.responseText&&(v.responseXML=k(v.responseText));try{j=L(v,i,m)}catch(e){r="parsererror",v.error=t=e||r}}catch(e){C("error caught: ",e),r="error",v.error=t=e||r}v.aborted&&(C("upload aborted"),r=null),v.status&&(r=200<=v.status&&v.status<300||304===v.status?"success":"error"),"success"===r?(m.success&&m.success.call(m.context,j,"success",v),b.resolve(v.responseText,"success",v),p&&X.event.trigger("ajaxSuccess",[v,m])):r&&(void 0===t&&(t=v.statusText),m.error&&m.error.call(m.context,v,r,t),b.reject(v,"error",t),p&&X.event.trigger("ajaxError",[v,m,t])),p&&X.event.trigger("ajaxComplete",[v,m]),p&&!--X.active&&X.event.trigger("ajaxStop"),m.complete&&m.complete.call(m.context,v,r),S=!0,m.timeout&&clearTimeout(x),setTimeout(function(){m.iframeTarget?d.attr("src",m.iframeSrc):d.remove(),v.responseXML=null},100)}}}var r,a,m,p,i,d,h,v,n,o,g,x,s=F[0],b=X.Deferred();if(b.abort=function(e){v.abort(e)},e)for(a=0;a<O.length;a++)r=X(O[a]),_?r.prop("disabled",!1):r.removeAttr("disabled");if((m=X.extend(!0,{},X.ajaxSettings,E)).context=m.context||m,i="jqFormIO"+(new Date).getTime(),m.iframeTarget?(o=(d=X(m.iframeTarget)).attr2("name"))?i=o:d.attr2("name",i):(d=X('<iframe name="'+i+'" src="'+m.iframeSrc+'" />')).css({position:"absolute",top:"-1000px",left:"-1000px"}),h=d[0],v={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var t="timeout"===e?"timeout":"aborted";C("aborting upload... "+t),this.aborted=1;try{h.contentWindow.document.execCommand&&h.contentWindow.document.execCommand("Stop")}catch(e){}d.attr("src",m.iframeSrc),v.error=t,m.error&&m.error.call(m.context,v,t,e),p&&X.event.trigger("ajaxError",[v,m,t]),m.complete&&m.complete.call(m.context,v,t)}},(p=m.global)&&0==X.active++&&X.event.trigger("ajaxStart"),p&&X.event.trigger("ajaxSend",[v,m]),m.beforeSend&&!1===m.beforeSend.call(m.context,v,m))return m.global&&X.active--,b.reject(),b;if(v.aborted)return b.reject(),b;(n=s.clk)&&((o=n.name)&&!n.disabled&&(m.extraData=m.extraData||{},m.extraData[o]=n.value,"image"==n.type&&(m.extraData[o+".x"]=s.clk_x,m.extraData[o+".y"]=s.clk_y)));var y=1,T=2,u=X("meta[name=csrf-token]").attr("content"),c=X("meta[name=csrf-param]").attr("content");c&&u&&(m.extraData=m.extraData||{},m.extraData[c]=u),m.forceSync?t():setTimeout(t,10);var j,w,S,D=50,k=X.parseXML||function(e,t){return window.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},A=X.parseJSON||function(e){return window.eval("("+e+")")},L=function(e,t,r){var a=e.getResponseHeader("content-type")||"",n="xml"===t||!t&&0<=a.indexOf("xml"),i=n?e.responseXML:e.responseText;return n&&"parsererror"===i.documentElement.nodeName&&X.error&&X.error("parsererror"),r&&r.dataFilter&&(i=r.dataFilter(i,t)),"string"==typeof i&&("json"===t||!t&&0<=a.indexOf("json")?i=A(i):("script"===t||!t&&0<=a.indexOf("javascript"))&&X.globalEval(i)),i};return b}if(!this.length)return C("ajaxSubmit: skipping submit process - no element selected"),this;var M,t,r,F=this;"function"==typeof E?E={success:E}:void 0===E&&(E={}),M=E.type||this.attr2("method"),(r=(r="string"==typeof(t=E.url||this.attr2("action"))?X.trim(t):"")||window.location.href||"")&&(r=(r.match(/^([^#]+)/)||[])[1]),E=X.extend(!0,{url:r,success:X.ajaxSettings.success,type:M||X.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},E);var a={};if(this.trigger("form-pre-serialize",[this,E,a]),a.veto)return C("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(E.beforeSerialize&&!1===E.beforeSerialize(this,E))return C("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var n=E.traditional;void 0===n&&(n=X.ajaxSettings.traditional);var i,O=[],o=this.formToArray(E.semantic,O);if(E.data&&(E.extraData=E.data,i=X.param(E.data,n)),E.beforeSubmit&&!1===E.beforeSubmit(o,this,E))return C("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[o,this,E,a]),a.veto)return C("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var s=X.param(o,n);i&&(s=s?s+"&"+i:i),"GET"==E.type.toUpperCase()?(E.url+=(0<=E.url.indexOf("?")?"&":"?")+s,E.data=null):E.data=s;var u=[];if(E.resetForm&&u.push(function(){F.resetForm()}),E.clearForm&&u.push(function(){F.clearForm(E.includeHidden)}),!E.dataType&&E.target){var c=E.success||function(){};u.push(function(e){var t=E.replaceTarget?"replaceWith":"html";X(E.target)[t](e).each(c,arguments)})}else E.success&&u.push(E.success);if(E.success=function(e,t,r){for(var a=E.context||this,n=0,i=u.length;n<i;n++)u[n].apply(a,[e,t,r||F,F])},E.error){var l=E.error;E.error=function(e,t,r){var a=E.context||this;l.apply(a,[e,t,r,F])}}if(E.complete){var f=E.complete;E.complete=function(e,t){var r=E.context||this;f.apply(r,[e,t,F])}}var m=0<X("input[type=file]:enabled",this).filter(function(){return""!==X(this).val()}).length,p="multipart/form-data",d=F.attr("enctype")==p||F.attr("encoding")==p,h=b.fileapi&&b.formdata;C("fileAPI :"+h);var v,g=(m||d)&&!h;!1!==E.iframe&&(E.iframe||g)?E.closeKeepAlive?X.get(E.closeKeepAlive,function(){v=e(o)}):v=e(o):v=(m||d)&&h?function(e){for(var r=new FormData,t=0;t<e.length;t++)r.append(e[t].name,e[t].value);if(E.extraData){var a=function(e){var t,r,a=X.param(e,E.traditional).split("&"),n=a.length,i=[];for(t=0;t<n;t++)a[t]=a[t].replace(/\+/g," "),r=a[t].split("="),i.push([decodeURIComponent(r[0]),decodeURIComponent(r[1])]);return i}(E.extraData);for(t=0;t<a.length;t++)a[t]&&r.append(a[t][0],a[t][1])}E.data=null;var n=X.extend(!0,{},X.ajaxSettings,E,{contentType:!1,processData:!1,cache:!1,type:M||"POST"});E.uploadProgress&&(n.xhr=function(){var e=X.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){var t=0,r=e.loaded||e.position,a=e.total;e.lengthComputable&&(t=Math.ceil(r/a*100)),E.uploadProgress(e,r,a,t)},!1),e}),n.data=null;var i=n.beforeSend;return n.beforeSend=function(e,t){t.data=E.formData?E.formData:r,i&&i.call(this,e,t)},X.ajax(n)}(o):X.ajax(E),F.removeData("jqxhr").data("jqxhr",v);for(var x=0;x<O.length;x++)O[x]=null;return this.trigger("form-submit-notify",[this,E]),this},X.fn.ajaxForm=function(e){if((e=e||{}).delegation=e.delegation&&X.isFunction(X.fn.on),e.delegation||0!==this.length)return e.delegation?(X(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,e,r).on("click.form-plugin",this.selector,e,a),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,r).bind("click.form-plugin",e,a);var t={s:this.selector,c:this.context};return!X.isReady&&t.s?(C("DOM not ready, queuing ajaxForm"),X(function(){X(t.s,t.c).ajaxForm(e)})):C("terminating; zero elements found by selector"+(X.isReady?"":" (DOM not ready)")),this},X.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},X.fn.formToArray=function(e,t){var r=[];if(0===this.length)return r;var a,n,i,o,s,u,c,l,f=this[0],m=this.attr("id"),p=e?f.getElementsByTagName("*"):f.elements;if(p&&!/MSIE [678]/.test(navigator.userAgent)&&(p=X(p).get()),m&&((a=X(':input[form="'+m+'"]').get()).length&&(p=(p||[]).concat(a))),!p||!p.length)return r;for(n=0,c=p.length;n<c;n++)if((o=(u=p[n]).name)&&!u.disabled)if(e&&f.clk&&"image"==u.type)f.clk==u&&(r.push({name:o,value:X(u).val(),type:u.type}),r.push({name:o+".x",value:f.clk_x},{name:o+".y",value:f.clk_y}));else if((s=X.fieldValue(u,!0))&&s.constructor==Array)for(t&&t.push(u),i=0,l=s.length;i<l;i++)r.push({name:o,value:s[i]});else if(b.fileapi&&"file"==u.type){t&&t.push(u);var d=u.files;if(d.length)for(i=0;i<d.length;i++)r.push({name:o,value:d[i],type:u.type});else r.push({name:o,value:"",type:u.type})}else null!=s&&(t&&t.push(u),r.push({name:o,value:s,type:u.type,required:u.required}));if(!e&&f.clk){var h=X(f.clk),v=h[0];(o=v.name)&&!v.disabled&&"image"==v.type&&(r.push({name:o,value:h.val()}),r.push({name:o+".x",value:f.clk_x},{name:o+".y",value:f.clk_y}))}return r},X.fn.formSerialize=function(e){return X.param(this.formToArray(e))},X.fn.fieldSerialize=function(n){var i=[];return this.each(function(){var e=this.name;if(e){var t=X.fieldValue(this,n);if(t&&t.constructor==Array)for(var r=0,a=t.length;r<a;r++)i.push({name:e,value:t[r]});else null!=t&&i.push({name:this.name,value:t})}}),X.param(i)},X.fn.fieldValue=function(e){for(var t=[],r=0,a=this.length;r<a;r++){var n=this[r],i=X.fieldValue(n,e);null==i||i.constructor==Array&&!i.length||(i.constructor==Array?X.merge(t,i):t.push(i))}return t},X.fieldValue=function(e,t){var r=e.name,a=e.type,n=e.tagName.toLowerCase();if(void 0===t&&(t=!0),t&&(!r||e.disabled||"reset"==a||"button"==a||("checkbox"==a||"radio"==a)&&!e.checked||("submit"==a||"image"==a)&&e.form&&e.form.clk!=e||"select"==n&&-1==e.selectedIndex))return null;if("select"!=n)return X(e).val();var i=e.selectedIndex;if(i<0)return null;for(var o=[],s=e.options,u="select-one"==a,c=u?i+1:s.length,l=u?i:0;l<c;l++){var f=s[l];if(f.selected){var m=f.value;if(m||(m=f.attributes&&f.attributes.value&&!f.attributes.value.specified?f.text:f.value),u)return m;o.push(m)}}return o},X.fn.clearForm=function(e){return this.each(function(){X("input,select,textarea",this).clearFields(e)})},X.fn.clearFields=X.fn.clearInputs=function(r){var a=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();a.test(e)||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t?this.selectedIndex=-1:"file"==e?/MSIE/.test(navigator.userAgent)?X(this).replaceWith(X(this).clone(!0)):X(this).val(""):r&&(!0===r&&/hidden/.test(e)||"string"==typeof r&&X(this).is(r))&&(this.value="")})},X.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},X.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},X.fn.selected=function(r){return void 0===r&&(r=!0),this.each(function(){var e=this.type;if("checkbox"==e||"radio"==e)this.checked=r;else if("option"==this.tagName.toLowerCase()){var t=X(this).parent("select");r&&t[0]&&"select-one"==t[0].type&&t.find("option").selected(!1),this.selected=r}})},X.fn.ajaxSubmit.debug=!1});